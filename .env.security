# üîê CONFIGURA√á√ïES DE SEGURAN√áA - PRODU√á√ÉO
# Este arquivo cont√©m as configura√ß√µes de seguran√ßa recomendadas para produ√ß√£o
# Copie estas configura√ß√µes para seu .env em produ√ß√£o

# ========================================
# AMBIENTE
# ========================================
NODE_ENV=production

# ========================================
# JWT SECRETS (OBRIGAT√ìRIO - Gerar valores √∫nicos!)
# ========================================
# Gerar com: openssl rand -hex 32
JWT_ACCESS_SECRET=CHANGE_THIS_TO_RANDOM_64_CHARACTER_STRING_IN_PRODUCTION
JWT_REFRESH_SECRET=CHANGE_THIS_TO_ANOTHER_RANDOM_64_CHARACTER_STRING_IN_PRODUCTION

# Tempo de expira√ß√£o dos tokens
JWT_ACCESS_EXPIRY=15m       # 15 minutos para access token
JWT_REFRESH_EXPIRY=7d       # 7 dias para refresh token

# ========================================
# SESSION & CSRF
# ========================================
# Gerar com: openssl rand -hex 32
SESSION_SECRET=CHANGE_THIS_TO_RANDOM_32_CHARACTER_STRING_IN_PRODUCTION
CSRF_SECRET=CHANGE_THIS_TO_RANDOM_32_CHARACTER_STRING_IN_PRODUCTION

# ========================================
# SEGURAN√áA DE HEADERS
# ========================================
ENABLE_HSTS=true               # HTTP Strict Transport Security
ENABLE_CSP=true                # Content Security Policy
FRAME_OPTIONS=DENY             # Previne clickjacking
XSS_PROTECTION=true            # Ativa prote√ß√£o XSS do browser
CONTENT_TYPE_NOSNIFF=true      # Previne MIME sniffing

# ========================================
# RATE LIMITING
# ========================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000    # 15 minutos
RATE_LIMIT_MAX_REQUESTS=100    # Max requests por janela

# Rate limits espec√≠ficos
LOGIN_RATE_LIMIT_MAX=5         # Max tentativas de login
API_RATE_LIMIT_MAX=1000        # Max requests API (usu√°rio autenticado)
WEBHOOK_RATE_LIMIT_MAX=500     # Max webhook requests por minuto

# ========================================
# CORS
# ========================================
CORS_ENABLED=true
CORS_ORIGIN=https://yourdomain.com  # Dom√≠nio espec√≠fico, n√£o use * em produ√ß√£o
CORS_CREDENTIALS=true

# ========================================
# COOKIES
# ========================================
COOKIE_SECURE=true             # HTTPS only
COOKIE_HTTP_ONLY=true          # N√£o acess√≠vel via JavaScript
COOKIE_SAME_SITE=strict        # Previne CSRF
COOKIE_MAX_AGE=86400000        # 24 horas

# ========================================
# LOGGING & MONITORING
# ========================================
LOG_LEVEL=warn                 # debug, info, warn, error, fatal
ENABLE_SECURITY_LOGS=true
ENABLE_AUDIT_LOGS=true
LOG_FILE=/var/log/auzap/app.log

# Integra√ß√£o com servi√ßos de monitoramento
SENTRY_DSN=                    # Sentry para error tracking
AUDIT_WEBHOOK_URL=             # Webhook para logs de auditoria
AUDIT_API_KEY=                 # API key para webhook de auditoria

# ========================================
# PROTE√á√ïES ADICIONAIS
# ========================================
BLOCK_SUSPICIOUS_REQUESTS=true # Bloqueia requisi√ß√µes suspeitas
ENABLE_TIMING_ATTACK_PREVENTION=true
ENABLE_HPP_PREVENTION=true     # HTTP Parameter Pollution

# ========================================
# DATABASE SECURITY
# ========================================
DB_SSL_MODE=require            # For√ßa SSL para PostgreSQL
DB_CONNECTION_TIMEOUT=5000     # 5 segundos
DB_STATEMENT_TIMEOUT=30000     # 30 segundos para queries

# ========================================
# REDIS SECURITY
# ========================================
REDIS_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD
REDIS_TLS=true                 # Usa TLS para Redis

# ========================================
# BCRYPT
# ========================================
BCRYPT_ROUNDS=12               # N√∫mero de rounds para hash (10-15 recomendado)

# ========================================
# FILE UPLOAD (se aplic√°vel)
# ========================================
MAX_FILE_SIZE=10485760         # 10MB em bytes
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf
UPLOAD_SCAN_VIRUSES=true       # Requer ClamAV ou similar

# ========================================
# API KEYS & EXTERNAL SERVICES
# ========================================
# Sempre use secrets manager em produ√ß√£o (AWS Secrets Manager, Vault, etc)
# Nunca commite valores reais no reposit√≥rio

# ========================================
# COMPLIANCE
# ========================================
ENABLE_GDPR_MODE=true          # Ativa funcionalidades LGPD/GDPR
DATA_RETENTION_DAYS=730        # 2 anos de reten√ß√£o de dados
ENABLE_RIGHT_TO_FORGET=true    # Permite exclus√£o de dados pessoais

# ========================================
# BACKUP & RECOVERY
# ========================================
ENABLE_AUTO_BACKUP=true
BACKUP_ENCRYPTION=true
BACKUP_RETENTION_DAYS=30

# ========================================
# NETWORK
# ========================================
TRUSTED_PROXIES=               # IPs de proxies confi√°veis (load balancers)
IP_WHITELIST=                  # Lista de IPs permitidos (opcional)
IP_BLACKLIST=                  # Lista de IPs bloqueados

# ========================================
# 2FA (Two-Factor Authentication)
# ========================================
ENABLE_2FA=false               # Ativar quando implementado
TOTP_WINDOW=1                  # Janela de toler√¢ncia para TOTP
BACKUP_CODES_COUNT=10          # N√∫mero de c√≥digos de backup

# ========================================
# NOTES
# ========================================
# 1. SEMPRE gere secrets √∫nicos para produ√ß√£o
# 2. NUNCA reutilize secrets entre ambientes
# 3. NUNCA commite secrets reais no git
# 4. Use um gerenciador de secrets em produ√ß√£o
# 5. Rotacione secrets regularmente (90 dias)
# 6. Monitore logs de seguran√ßa ativamente
# 7. Fa√ßa backup das configura√ß√µes de seguran√ßa
# 8. Teste as configura√ß√µes antes do deploy
# 9. Mantenha depend√™ncias atualizadas
# 10. Realize auditorias de seguran√ßa regulares